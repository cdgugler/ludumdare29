function Shatter(a,b,c,d){this.img=a,this.numPolys=b,this.images=[];var e,c=c||1;e=this.getPolys(a.width,a.height,b),this.roundVertices(e),this.calcBoundaries(e,this.img),this.scaleCoordinates(e,c),this.images=this.spliceImage(e,a),d&&(this.debug=this.getDebugImage(e,"#fff"))}!function(){function a(a,b){return b>a?-1:a>b?1:a>=b?0:0/0}function b(a){return null!=a&&!isNaN(a)}function c(a){return{left:function(b,c,d,e){for(arguments.length<3&&(d=0),arguments.length<4&&(e=b.length);e>d;){var f=d+e>>>1;a(b[f],c)<0?d=f+1:e=f}return d},right:function(b,c,d,e){for(arguments.length<3&&(d=0),arguments.length<4&&(e=b.length);e>d;){var f=d+e>>>1;a(b[f],c)>0?e=f:d=f+1}return d}}}function d(a){return a.length}function e(a){for(var b=1;a*b%1;)b*=10;return b}function f(a,b){try{for(var c in b)Object.defineProperty(a.prototype,c,{value:b[c],enumerable:!1})}catch(d){a.prototype=b}}function g(){}function h(a){return W+a in this}function i(a){return a=W+a,a in this&&delete this[a]}function j(){var a=[];return this.forEach(function(b){a.push(b)}),a}function k(){var a=0;for(var b in this)b.charCodeAt(0)===X&&++a;return a}function l(){for(var a in this)if(a.charCodeAt(0)===X)return!1;return!0}function m(){}function n(a){return"function"==typeof a?a:function(){return a}}function o(){K(this),this.edge=this.site=this.circle=null}function p(a){var b=db.pop()||new o;return b.site=a,b}function q(a){A(a),$.remove(a),db.push(a),K(a)}function r(a){var b=a.circle,c=b.x,d=b.cy,e={x:c,y:d},f=a.P,g=a.N,h=[a];q(a);for(var i=f;i.circle&&V(c-i.circle.x)<bb&&V(d-i.circle.cy)<bb;)f=i.P,h.unshift(i),q(i),i=f;h.unshift(i),A(i);for(var j=g;j.circle&&V(c-j.circle.x)<bb&&V(d-j.circle.cy)<bb;)g=j.N,h.push(j),q(j),j=g;h.push(j),A(j);var k,l=h.length;for(k=1;l>k;++k)j=h[k],i=h[k-1],H(j.edge,i.site,j.site,e);i=h[0],j=h[l-1],j.edge=F(i.site,j.site,null,e),z(i),z(j)}function s(a){for(var b,c,d,e,f=a.x,g=a.y,h=$._;h;)if(d=t(h,g)-f,d>bb)h=h.L;else{if(e=f-u(h,g),!(e>bb)){d>-bb?(b=h.P,c=h):e>-bb?(b=h,c=h.N):b=c=h;break}if(!h.R){b=h;break}h=h.R}var i=p(a);if($.insert(b,i),b||c){if(b===c)return A(b),c=p(b.site),$.insert(i,c),i.edge=c.edge=F(b.site,i.site),z(b),void z(c);if(!c)return void(i.edge=F(b.site,i.site));A(b),A(c);var j=b.site,k=j.x,l=j.y,m=a.x-k,n=a.y-l,o=c.site,q=o.x-k,r=o.y-l,s=2*(m*r-n*q),v=m*m+n*n,w=q*q+r*r,x={x:(r*v-n*w)/s+k,y:(m*w-q*v)/s+l};H(c.edge,j,o,x),i.edge=F(j,a,null,x),c.edge=F(a,o,null,x),z(b),z(c)}}function t(a,b){var c=a.site,d=c.x,e=c.y,f=e-b;if(!f)return d;var g=a.P;if(!g)return-1/0;c=g.site;var h=c.x,i=c.y,j=i-b;if(!j)return h;var k=h-d,l=1/f-1/j,m=k/j;return l?(-m+Math.sqrt(m*m-2*l*(k*k/(-2*j)-i+j/2+e-f/2)))/l+d:(d+h)/2}function u(a,b){var c=a.N;if(c)return t(c,b);var d=a.site;return d.y===b?d.x:1/0}function v(a){this.site=a,this.edges=[]}function w(a){for(var b,c,d,e,f,g,h,i,j,k,l=a[0][0],m=a[1][0],n=a[0][1],o=a[1][1],p=Z,q=p.length;q--;)if(f=p[q],f&&f.prepare())for(h=f.edges,i=h.length,g=0;i>g;)k=h[g].end(),d=k.x,e=k.y,j=h[++g%i].start(),b=j.x,c=j.y,(V(d-b)>bb||V(e-c)>bb)&&(h.splice(g,0,new I(G(f.site,k,V(d-l)<bb&&o-e>bb?{x:l,y:V(b-l)<bb?c:o}:V(e-o)<bb&&m-d>bb?{x:V(c-o)<bb?b:m,y:o}:V(d-m)<bb&&e-n>bb?{x:m,y:V(b-m)<bb?c:n}:V(e-n)<bb&&d-l>bb?{x:V(c-n)<bb?b:l,y:n}:null),f.site,null)),++i)}function x(a,b){return b.angle-a.angle}function y(){K(this),this.x=this.y=this.arc=this.site=this.cy=null}function z(a){var b=a.P,c=a.N;if(b&&c){var d=b.site,e=a.site,f=c.site;if(d!==f){var g=e.x,h=e.y,i=d.x-g,j=d.y-h,k=f.x-g,l=f.y-h,m=2*(i*l-j*k);if(!(m>=-cb)){var n=i*i+j*j,o=k*k+l*l,p=(l*n-j*o)/m,q=(i*o-k*n)/m,l=q+h,r=eb.pop()||new y;r.arc=a,r.site=e,r.x=p+g,r.y=l+Math.sqrt(p*p+q*q),r.cy=l,a.circle=r;for(var s=null,t=ab._;t;)if(r.y<t.y||r.y===t.y&&r.x<=t.x){if(!t.L){s=t.P;break}t=t.L}else{if(!t.R){s=t;break}t=t.R}ab.insert(s,r),s||(_=r)}}}}function A(a){var b=a.circle;b&&(b.P||(_=b.N),ab.remove(b),eb.push(b),K(b),a.circle=null)}function B(a,b,c,d){return function(e){var f,g=e.a,h=e.b,i=g.x,j=g.y,k=h.x,l=h.y,m=0,n=1,o=k-i,p=l-j;if(f=a-i,o||!(f>0)){if(f/=o,0>o){if(m>f)return;n>f&&(n=f)}else if(o>0){if(f>n)return;f>m&&(m=f)}if(f=c-i,o||!(0>f)){if(f/=o,0>o){if(f>n)return;f>m&&(m=f)}else if(o>0){if(m>f)return;n>f&&(n=f)}if(f=b-j,p||!(f>0)){if(f/=p,0>p){if(m>f)return;n>f&&(n=f)}else if(p>0){if(f>n)return;f>m&&(m=f)}if(f=d-j,p||!(0>f)){if(f/=p,0>p){if(f>n)return;f>m&&(m=f)}else if(p>0){if(m>f)return;n>f&&(n=f)}return m>0&&(e.a={x:i+m*o,y:j+m*p}),1>n&&(e.b={x:i+n*o,y:j+n*p}),e}}}}}}function C(a){for(var b,c=Y,d=B(a[0][0],a[0][1],a[1][0],a[1][1]),e=c.length;e--;)b=c[e],(!D(b,a)||!d(b)||V(b.a.x-b.b.x)<bb&&V(b.a.y-b.b.y)<bb)&&(b.a=b.b=null,c.splice(e,1))}function D(a,b){var c=a.b;if(c)return!0;var d,e,f=a.a,g=b[0][0],h=b[1][0],i=b[0][1],j=b[1][1],k=a.l,l=a.r,m=k.x,n=k.y,o=l.x,p=l.y,q=(m+o)/2,r=(n+p)/2;if(p===n){if(g>q||q>=h)return;if(m>o){if(f){if(f.y>=j)return}else f={x:q,y:i};c={x:q,y:j}}else{if(f){if(f.y<i)return}else f={x:q,y:j};c={x:q,y:i}}}else if(d=(m-o)/(p-n),e=r-d*q,-1>d||d>1)if(m>o){if(f){if(f.y>=j)return}else f={x:(i-e)/d,y:i};c={x:(j-e)/d,y:j}}else{if(f){if(f.y<i)return}else f={x:(j-e)/d,y:j};c={x:(i-e)/d,y:i}}else if(p>n){if(f){if(f.x>=h)return}else f={x:g,y:d*g+e};c={x:h,y:d*h+e}}else{if(f){if(f.x<g)return}else f={x:h,y:d*h+e};c={x:g,y:d*g+e}}return a.a=f,a.b=c,!0}function E(a,b){this.l=a,this.r=b,this.a=this.b=null}function F(a,b,c,d){var e=new E(a,b);return Y.push(e),c&&H(e,a,b,c),d&&H(e,b,a,d),Z[a.i].edges.push(new I(e,a,b)),Z[b.i].edges.push(new I(e,b,a)),e}function G(a,b,c){var d=new E(a,null);return d.a=b,d.b=c,Y.push(d),d}function H(a,b,c,d){a.a||a.b?a.l===c?a.b=d:a.a=d:(a.a=d,a.l=b,a.r=c)}function I(a,b,c){var d=a.a,e=a.b;this.edge=a,this.site=b,this.angle=c?Math.atan2(c.y-b.y,c.x-b.x):a.l===b?Math.atan2(e.x-d.x,d.y-e.y):Math.atan2(d.x-e.x,e.y-d.y)}function J(){this._=null}function K(a){a.U=a.C=a.L=a.R=a.P=a.N=null}function L(a,b){var c=b,d=b.R,e=c.U;e?e.L===c?e.L=d:e.R=d:a._=d,d.U=e,c.U=d,c.R=d.L,c.R&&(c.R.U=c),d.L=c}function M(a,b){var c=b,d=b.L,e=c.U;e?e.L===c?e.L=d:e.R=d:a._=d,d.U=e,c.U=d,c.L=d.R,c.L&&(c.L.U=c),d.R=c}function N(a){for(;a.L;)a=a.L;return a}function O(a,b){var c,d,e,f=a.sort(P).pop();for(Y=[],Z=new Array(a.length),$=new J,ab=new J;;)if(e=_,f&&(!e||f.y<e.y||f.y===e.y&&f.x<e.x))(f.x!==c||f.y!==d)&&(Z[f.i]=new v(f),s(f),c=f.x,d=f.y),f=a.pop();else{if(!e)break;r(e.arc)}b&&(C(b),w(b));var g={cells:Z,edges:Y};return $=ab=Y=Z=null,g}function P(a,b){return b.y-a.y||b.x-a.x}function Q(a){return a[0]}function R(a){return a[1]}function S(a,b,c){return(a.x-c.x)*(b.y-a.y)-(a.x-b.x)*(c.y-a.y)}var T={version:"3.4.8"};T.ascending=a,T.descending=function(a,b){return a>b?-1:b>a?1:b>=a?0:0/0},T.min=function(a,b){var c,d,e=-1,f=a.length;if(1===arguments.length){for(;++e<f&&!(null!=(c=a[e])&&c>=c);)c=void 0;for(;++e<f;)null!=(d=a[e])&&c>d&&(c=d)}else{for(;++e<f&&!(null!=(c=b.call(a,a[e],e))&&c>=c);)c=void 0;for(;++e<f;)null!=(d=b.call(a,a[e],e))&&c>d&&(c=d)}return c},T.max=function(a,b){var c,d,e=-1,f=a.length;if(1===arguments.length){for(;++e<f&&!(null!=(c=a[e])&&c>=c);)c=void 0;for(;++e<f;)null!=(d=a[e])&&d>c&&(c=d)}else{for(;++e<f&&!(null!=(c=b.call(a,a[e],e))&&c>=c);)c=void 0;for(;++e<f;)null!=(d=b.call(a,a[e],e))&&d>c&&(c=d)}return c},T.extent=function(a,b){var c,d,e,f=-1,g=a.length;if(1===arguments.length){for(;++f<g&&!(null!=(c=e=a[f])&&c>=c);)c=e=void 0;for(;++f<g;)null!=(d=a[f])&&(c>d&&(c=d),d>e&&(e=d))}else{for(;++f<g&&!(null!=(c=e=b.call(a,a[f],f))&&c>=c);)c=void 0;for(;++f<g;)null!=(d=b.call(a,a[f],f))&&(c>d&&(c=d),d>e&&(e=d))}return[c,e]},T.sum=function(a,b){var c,d=0,e=a.length,f=-1;if(1===arguments.length)for(;++f<e;)isNaN(c=+a[f])||(d+=c);else for(;++f<e;)isNaN(c=+b.call(a,a[f],f))||(d+=c);return d},T.mean=function(a,c){var d,e=0,f=a.length,g=-1,h=f;if(1===arguments.length)for(;++g<f;)b(d=a[g])?e+=d:--h;else for(;++g<f;)b(d=c.call(a,a[g],g))?e+=d:--h;return h?e/h:void 0},T.quantile=function(a,b){var c=(a.length-1)*b+1,d=Math.floor(c),e=+a[d-1],f=c-d;return f?e+f*(a[d]-e):e},T.median=function(c,d){return arguments.length>1&&(c=c.map(d)),c=c.filter(b),c.length?T.quantile(c.sort(a),.5):void 0};var U=c(a);T.bisectLeft=U.left,T.bisect=T.bisectRight=U.right,T.bisector=function(b){return c(1===b.length?function(c,d){return a(b(c),d)}:b)},T.shuffle=function(a){for(var b,c,d=a.length;d;)c=Math.random()*d--|0,b=a[d],a[d]=a[c],a[c]=b;return a},T.permute=function(a,b){for(var c=b.length,d=new Array(c);c--;)d[c]=a[b[c]];return d},T.pairs=function(a){for(var b,c=0,d=a.length-1,e=a[0],f=new Array(0>d?0:d);d>c;)f[c]=[b=e,e=a[++c]];return f},T.zip=function(){if(!(e=arguments.length))return[];for(var a=-1,b=T.min(arguments,d),c=new Array(b);++a<b;)for(var e,f=-1,g=c[a]=new Array(e);++f<e;)g[f]=arguments[f][a];return c},T.transpose=function(a){return T.zip.apply(T,a)},T.keys=function(a){var b=[];for(var c in a)b.push(c);return b},T.values=function(a){var b=[];for(var c in a)b.push(a[c]);return b},T.entries=function(a){var b=[];for(var c in a)b.push({key:c,value:a[c]});return b},T.merge=function(a){for(var b,c,d,e=a.length,f=-1,g=0;++f<e;)g+=a[f].length;for(c=new Array(g);--e>=0;)for(d=a[e],b=d.length;--b>=0;)c[--g]=d[b];return c};var V=Math.abs;T.range=function(a,b,c){if(arguments.length<3&&(c=1,arguments.length<2&&(b=a,a=0)),(b-a)/c===1/0)throw new Error("infinite range");var d,f=[],g=e(V(c)),h=-1;if(a*=g,b*=g,c*=g,0>c)for(;(d=a+c*++h)>b;)f.push(d/g);else for(;(d=a+c*++h)<b;)f.push(d/g);return f},T.map=function(a){var b=new g;if(a instanceof g)a.forEach(function(a,c){b.set(a,c)});else for(var c in a)b.set(c,a[c]);return b},f(g,{has:h,get:function(a){return this[W+a]},set:function(a,b){return this[W+a]=b},remove:i,keys:j,values:function(){var a=[];return this.forEach(function(b,c){a.push(c)}),a},entries:function(){var a=[];return this.forEach(function(b,c){a.push({key:b,value:c})}),a},size:k,empty:l,forEach:function(a){for(var b in this)b.charCodeAt(0)===X&&a.call(this,b.substring(1),this[b])}});var W="\x00",X=W.charCodeAt(0);T.nest=function(){function a(b,h,i){if(i>=f.length)return d?d.call(e,h):c?h.sort(c):h;for(var j,k,l,m,n=-1,o=h.length,p=f[i++],q=new g;++n<o;)(m=q.get(j=p(k=h[n])))?m.push(k):q.set(j,[k]);return b?(k=b(),l=function(c,d){k.set(c,a(b,d,i))}):(k={},l=function(c,d){k[c]=a(b,d,i)}),q.forEach(l),k}function b(a,c){if(c>=f.length)return a;var d=[],e=h[c++];return a.forEach(function(a,e){d.push({key:a,values:b(e,c)})}),e?d.sort(function(a,b){return e(a.key,b.key)}):d}var c,d,e={},f=[],h=[];return e.map=function(b,c){return a(c,b,0)},e.entries=function(c){return b(a(T.map,c,0),0)},e.key=function(a){return f.push(a),e},e.sortKeys=function(a){return h[f.length-1]=a,e},e.sortValues=function(a){return c=a,e},e.rollup=function(a){return d=a,e},e},T.set=function(a){var b=new m;if(a)for(var c=0,d=a.length;d>c;++c)b.add(a[c]);return b},f(m,{has:h,add:function(a){return this[W+a]=!0,a},remove:function(a){return a=W+a,a in this&&delete this[a]},values:j,size:k,empty:l,forEach:function(a){for(var b in this)b.charCodeAt(0)===X&&a.call(this,b.substring(1))}}),T.functor=n;var Y,Z,$,_,ab,bb=(Math.PI,1e-6),cb=bb*bb,db=[],eb=[];v.prototype.prepare=function(){for(var a,b=this.edges,c=b.length;c--;)a=b[c].edge,a.b&&a.a||b.splice(c,1);return b.sort(x),b.length},I.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},J.prototype={insert:function(a,b){var c,d,e;if(a){if(b.P=a,b.N=a.N,a.N&&(a.N.P=b),a.N=b,a.R){for(a=a.R;a.L;)a=a.L;a.L=b}else a.R=b;c=a}else this._?(a=N(this._),b.P=null,b.N=a,a.P=a.L=b,c=a):(b.P=b.N=null,this._=b,c=null);for(b.L=b.R=null,b.U=c,b.C=!0,a=b;c&&c.C;)d=c.U,c===d.L?(e=d.R,e&&e.C?(c.C=e.C=!1,d.C=!0,a=d):(a===c.R&&(L(this,c),a=c,c=a.U),c.C=!1,d.C=!0,M(this,d))):(e=d.L,e&&e.C?(c.C=e.C=!1,d.C=!0,a=d):(a===c.L&&(M(this,c),a=c,c=a.U),c.C=!1,d.C=!0,L(this,d))),c=a.U;this._.C=!1},remove:function(a){a.N&&(a.N.P=a.P),a.P&&(a.P.N=a.N),a.N=a.P=null;var b,c,d,e=a.U,f=a.L,g=a.R;if(c=f?g?N(g):f:g,e?e.L===a?e.L=c:e.R=c:this._=c,f&&g?(d=c.C,c.C=a.C,c.L=f,f.U=c,c!==g?(e=c.U,c.U=a.U,a=c.R,e.L=a,c.R=g,g.U=c):(c.U=e,e=c,a=c.R)):(d=a.C,a=c),a&&(a.U=e),!d){if(a&&a.C)return void(a.C=!1);do{if(a===this._)break;if(a===e.L){if(b=e.R,b.C&&(b.C=!1,e.C=!0,L(this,e),b=e.R),b.L&&b.L.C||b.R&&b.R.C){b.R&&b.R.C||(b.L.C=!1,b.C=!0,M(this,b),b=e.R),b.C=e.C,e.C=b.R.C=!1,L(this,e),a=this._;break}}else if(b=e.L,b.C&&(b.C=!1,e.C=!0,M(this,e),b=e.L),b.L&&b.L.C||b.R&&b.R.C){b.L&&b.L.C||(b.R.C=!1,b.C=!0,L(this,b),b=e.L),b.C=e.C,e.C=b.L.C=!1,M(this,e),a=this._;break}b.C=!0,a=e,e=e.U}while(!a.C);a&&(a.C=!1)}}},T.geom={},T.geom.voronoi=function(a){function b(a){var b=new Array(a.length),d=h[0][0],e=h[0][1],f=h[1][0],g=h[1][1];return O(c(a),h).cells.forEach(function(c,h){var i=c.edges,j=c.site,k=b[h]=i.length?i.map(function(a){var b=a.start();return[b.x,b.y]}):j.x>=d&&j.x<=f&&j.y>=e&&j.y<=g?[[d,g],[f,g],[f,e],[d,e]]:[];k.point=a[h]}),b}function c(a){return a.map(function(a,b){return{x:Math.round(f(a,b)/bb)*bb,y:Math.round(g(a,b)/bb)*bb,i:b}})}var d=Q,e=R,f=d,g=e,h=fb;return a?b(a):(b.links=function(a){return O(c(a)).edges.filter(function(a){return a.l&&a.r}).map(function(b){return{source:a[b.l.i],target:a[b.r.i]}})},b.triangles=function(a){var b=[];return O(c(a)).cells.forEach(function(c,d){for(var e,f,g=c.site,h=c.edges.sort(x),i=-1,j=h.length,k=h[j-1].edge,l=k.l===g?k.r:k.l;++i<j;)e=k,f=l,k=h[i].edge,l=k.l===g?k.r:k.l,d<f.i&&d<l.i&&S(g,f,l)<0&&b.push([a[d],a[f.i],a[l.i]])}),b},b.x=function(a){return arguments.length?(f=n(d=a),b):d},b.y=function(a){return arguments.length?(g=n(e=a),b):e},b.clipExtent=function(a){return arguments.length?(h=null==a?fb:a,b):h===fb?null:h},b.size=function(a){return arguments.length?b.clipExtent(a&&[[0,0],a]):h===fb?null:h&&h[1]},b)};var fb=[[-1e6,-1e6],[1e6,1e6]];"function"==typeof define&&define.amd?define(T):"object"==typeof module&&module.exports?module.exports=T:this.d3=T}(),Shatter.prototype.getPolys=function(a,b,c){var d=d3.range(c).map(function(){return[Math.random()*a,Math.random()*b]}),e=d3.geom.voronoi().clipExtent([[0,0],[a,b]]),f=e(d);return f},Shatter.prototype.roundVertices=function(a){a.forEach(function(a){a.forEach(function(a){a[0]=Math.round(a[0]),a[1]=Math.round(a[1])})})},Shatter.prototype.scaleCoordinates=function(a,b){var b=b;a.forEach(function(a){a.points=[];var c=(a.maxX+a.minX)/2,d=(a.maxY+a.minY)/2;a.forEach(function(e){var f=e[0]-a.minX,g=e[1]-a.minY;f=Math.round(b*(f-c)+c),g=Math.round(b*(g-d)+d),a.points.push(f,g)})})},Shatter.prototype.calcBoundaries=function(a,b){a.forEach(function(a){a.minX=b.width,a.minY=b.height,a.maxX=0,a.maxY=0,a.forEach(function(b){a.minX=b[0]<a.minX?b[0]:a.minX,a.minY=b[1]<a.minY?b[1]:a.minY,a.maxX=b[0]>a.maxX?b[0]:a.maxX,a.maxY=b[1]>a.maxY?b[1]:a.maxY})})},Shatter.prototype.spliceImage=function(a,b){imageList=[];var c=document.createElement("canvas");c.width=b.width,c.height=b.height;var d=c.getContext("2d");return d.save(),a.forEach(function(a){var e=Shatter.prototype.getClippedImage(a,d,c,b),f=Shatter.prototype.getCroppedImage(a,e);imageList.push({image:f,x:a.minX,y:a.minY,points:a.points}),f=null,d.restore(),d.clearRect(0,0,250,250),d.save()}),canvas=null,imageList},Shatter.prototype.getClippedImage=function(a,b,c,d){a.forEach(function(a,c,d){return 0===c?(b.beginPath(),void b.moveTo(a[0],a[1])):(b.lineTo(a[0],a[1]),void(c===d.length-1&&b.lineTo(d[0][0],d[0][1])))}),b.clip(),b.drawImage(d,0,0);var e=new Image;return e.src=c.toDataURL("image/png"),e},Shatter.prototype.getCroppedImage=function(a,b){var c=a.maxY-a.minY,d=a.maxX-a.minX,e=document.createElement("canvas");e.width=d,e.height=c,cropCtx=e.getContext("2d"),cropCtx.drawImage(b,-a.minX,-a.minY);var f=new Image;return f.src=e.toDataURL("image/png"),e=null,f},Shatter.prototype.getDebugImage=function(a,b){var c=document.createElement("canvas");c.width=this.img.width,c.height=this.img.height;var d=c.getContext("2d"),b=b||"#fff";a.forEach(function(a){a.forEach(function(a,b,c){return 0===b?(d.beginPath(),void d.moveTo(a[0],a[1])):(d.lineTo(a[0],a[1]),void(b===c.length-1&&d.lineTo(c[0][0],c[0][1])))}),d.closePath(),d.strokeStyle=b,d.stroke()});var e=new Image;return e.src=c.toDataURL("image/png"),e};